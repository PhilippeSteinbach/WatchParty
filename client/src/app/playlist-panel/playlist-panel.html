<div class="playlist-panel">
  <div class="add-form">
    <input
      type="text"
      placeholder="Paste video URL…"
      [ngModel]="urlInput()"
      (ngModelChange)="urlInput.set($event)"
      name="videoUrl"
      aria-label="Video URL"
      (keydown.enter)="addToQueue()"
    />
    <div class="add-actions">
      <button class="queue-btn" (click)="addToQueue()">+ Queue</button>
      <button class="play-now-btn" (click)="playNow()">▶ Play Now</button>
    </div>
  </div>

  <div
    class="playlist-list"
    role="list"
    cdkDropList
    (cdkDropListDropped)="onDrop($event)"
  >
    @for (item of items(); track item.id) {
      <div
        class="playlist-item"
        [class.now-playing]="isCurrentlyPlaying(item)"
        role="listitem"
        cdkDrag
      >
        <span class="drag-handle" cdkDragHandle>⠿</span>
        @if (item.thumbnailUrl) {
          <img
            class="thumbnail"
            [src]="item.thumbnailUrl"
            [alt]="displayTitle(item)"
          />
        }
        <div class="item-info">
          <span class="item-title">{{ displayTitle(item) }}</span>
          <span class="item-meta">
            {{ item.addedBy }} · {{ formatDuration(item.durationSeconds) }}
          </span>
        </div>
        <button
          class="item-play-btn"
          (click)="playItem(item)"
          aria-label="Play now"
        >
          ▶
        </button>
        <button
          class="remove-btn"
          (click)="removeItem(item.id)"
          aria-label="Remove item"
        >
          ×
        </button>
      </div>
    } @empty {
      <p class="empty-message">No items in playlist</p>
    }
  </div>

  <button class="next-btn" (click)="skipToNext()">⏭ Skip to Next</button>
</div>
