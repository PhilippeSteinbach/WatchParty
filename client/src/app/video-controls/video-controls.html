<div class="flex items-center gap-2 bg-surface-1 border-t border-border px-4 py-2 w-full">
  @if (hasVideo()) {
    <button
      class="w-8 h-8 rounded-full flex items-center justify-center bg-neon-purple/20 text-neon-purple hover:bg-neon-purple/30 transition disabled:opacity-40 disabled:cursor-default"
      (click)="togglePlayPause()"
      [disabled]="!canControl()"
      [attr.aria-label]="isPlaying() ? 'Pause' : 'Play'"
    >
      @if (isPlaying()) {
        <lucide-icon [img]="PauseIcon" [size]="16"></lucide-icon>
      } @else {
        <lucide-icon [img]="PlayIcon" [size]="16"></lucide-icon>
      }
    </button>
  } @else {
    <button
      class="w-8 h-8 rounded-full flex items-center justify-center bg-neon-purple/20 text-neon-purple opacity-40 cursor-default"
      disabled
      aria-label="Play"
    >
      <lucide-icon [img]="PlayIcon" [size]="16"></lucide-icon>
    </button>
  }

  <span class="text-xs text-purple-300/60 font-mono tabular-nums min-w-[3.5em] text-center select-none">{{ formatTime(displayTime()) }}</span>

  <div class="seek-wrapper flex-1">
    <input
      type="range"
      class="seek-bar"
      min="0"
      [max]="duration()"
      step="0.1"
      [value]="displayTime()"
      [style]="'--progress:' + progressPercent() + '%'"
      (mousedown)="onSeekStart()"
      (touchstart)="onSeekStart()"
      (input)="onSeeking($event)"
      (change)="onSeekEnd($event)"
      [disabled]="!canControl()"
      aria-label="Seek"
    />
    @if (isSeeking()) {
      <span
        class="seek-tooltip"
        [style.left.%]="progressPercent()"
      >{{ formatTime(seekTime()) }}</span>
    }
  </div>

  <div class="volume-controls flex items-center gap-2 ml-auto flex-shrink-0">
    <span class="text-xs text-purple-300/60 font-mono tabular-nums min-w-[3.5em] text-center select-none">{{ formatTime(duration()) }}</span>

    <button
      class="text-purple-300/60 hover:text-purple-300 transition p-1"
      (click)="toggleMute()"
      [attr.aria-label]="isMuted() ? 'Unmute' : 'Mute'"
    >
      @if (isMuted()) {
        <lucide-icon [img]="VolumeXIcon" [size]="16"></lucide-icon>
      } @else if (volume() < 50) {
        <lucide-icon [img]="Volume1Icon" [size]="16"></lucide-icon>
      } @else {
        <lucide-icon [img]="Volume2Icon" [size]="16"></lucide-icon>
      }
    </button>

    <input
      type="range"
      class="volume-slider"
      min="0"
      max="100"
      [value]="volume()"
      (input)="onVolumeChange($event)"
      aria-label="Volume"
    />
  </div>

  <button
    class="fullscreen-btn text-purple-300/60 hover:text-purple-300 transition p-1"
    (click)="toggleFullscreen.emit()"
    [attr.aria-label]="isFullscreen() ? 'Exit fullscreen' : 'Fullscreen'"
  >
    @if (isFullscreen()) {
      <lucide-icon [img]="MinimizeIcon" [size]="16"></lucide-icon>
    } @else {
      <lucide-icon [img]="MaximizeIcon" [size]="16"></lucide-icon>
    }
  </button>
</div>
